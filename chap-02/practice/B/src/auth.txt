TODO: fix login
NOTE: refactor
